package com.avantir.blowfish.clients.tcp;

import com.avantir.blowfish.services.KeyManagementService;
import com.avantir.blowfish.services.SecurityService;
import org.junit.Before;
import org.junit.Test;

/**
 * Created by lekanomotayo on 21/04/2018.
 */
public class ThalesHSMClientTest {

    ThalesHSMClient thalesHSMClient;
    SecurityService securityService;
    KeyManagementService keyManagementService;


    @Before
    public void setup() throws Exception{
        //thalesHSMClient = new ThalesHSMClient("localhost", 1501);
        //keyManagementService = new KeyManagementService();
    }

    /*
    @Test
    public void testgGeneratePrivateKey() throws Exception{
        thalesHSMClient.generatePrivateKey("2048", "010001");
    }

    @Test
    public void testGenerateDEK() throws Exception{
        thalesHSMClient.generateDEK();
    }


    @Test
    public void testImportKey() throws Exception{
        String publicKey = "3082010A02820101008ADCEC30FC7E1BC752753E9D50C8825AB7BB32DE55482DC3F15BC1EC4C5E4FE25C3D44E60DCC9818FFC4729E89DEE797ACF28005524698CD191725E7E04E835F43F9611C65B9F2879D44D58FF1EE1187B291665EFAC0B22C98A29137F51F94DA44972C588664889167111319735D151CCD7E00DEF99AF99D9C9943C20304544E9571FEDFA01586E99239715D234658D455477F32B0E5E3417278B6119EAA2F001BBDE13C4A0D5DC89E37BDCA2B016927D3441B9B9E67E6463FA36D2EEB7CC408C002075FC8EC3F62FCD72B9F7193B1CCC5B55B038FAB50B67CD2C142E7D403A9A5A111FBFFEA3DB3BD96585B8CB30651DDAA73F6606834DA19C813266C77490B0203010001";
        String keyToImport = "DBEECACCB4210977ACE73A1D873CA59F";
        String keyUnderPublicKey = securityService.encryptWithRSA(publicKey, keyToImport).get();
        String privateKey = "6DEC459E59521BCA05AA07BF0910ACFEEE02F1BEEE8A1622A3CE00E9DEB57D80B885FAE9169D40F252E14113023293962A70ED68B42AE18B412B1AB0A544CF0D1C14C2E882ADE884F561FE484187F798513944735D8539F940846E25CF9D33CB951F8B0C17837BC6E79ED392965A507358816B36BB9EED1D141C1A7C7D9E8017AA397D2BD20A11E7BAE88ECCE0AD01880B77BA219E5467EBD0A70140C12B70E810D1C57DAC21D6ABF6CFDAEE7DEE2B3ECE6B55D3C8C478CF28F480212101366F965D58C2E5FB4C348329A86E3EF5B40DC8B705E5AB07559D554FD6A0FBD8B96CF956CB23DC222C48C6D8BDDFADB6D9EE12B0DE2366A669EEE6638DAEA1F3678EF41DF73FCFC693382A03387B57FF7CDCA1CEBCD3938B058D61EFD76907D29A628A30156B8470147C71F6087FBB2E76F2BDFE09CE16E59C2CB48221BE882F8F09B51C479B1FB476670F11C4C497C8E9A1BA5789E38E0E5836B437B9EAAB25F79A334CACE05717B99E8A00D016955CBE41712EBBDCC8BE629F594D4E518B5BAE0D75C7675D7E97BC8D58478A2AE5B8DAFA9BE78A20B872671B15EBFD7301A5DC3C9BAFB68978504DE7D97B0468F6E33DC2E7757714CF3037560F29BC6C7CD4B3D828F92A873DB65792C6E8F10AE65B0248DAC12B51E0D4CD9F819F24BAE6AF590E441458A887DC46F3CCA5AF98ECFFB0A128E565E912AA95250C19D3F6CA21AE30A2CA1DBD8CC6F68E22F107AA278DCFC6BA78FE25EF1CB8BF1EA965ECC1CCD1AA7EB6E8978DB5D21C3EC4C3122CA675744DB0A40452A22E1328B3DCA2461A6FBF095D3A09569F7A6040EF8272D13BD069873A4BB23CA0CD76D957A634EE9EE89D8CEB8A275FE03A0DB20FE0312439ECD12B6124A338E77A39AD724862B7F389438E727309240AE3FDBEFB6A8296F7770E";
        thalesHSMClient.importKey(keyUnderPublicKey, privateKey, "0000");
    }

    @Test
    public void testEncrypt3DES() throws Exception{
        String keyUnderLMK = "952392F5CB403F240719CB199CFDC511";
        String chkDigit = "1DDD47BD92AF0000";
        String cipher = "5399831614073498";
        thalesHSMClient.encrypt3DES(keyUnderLMK, cipher);
    }

    @Test
    public void testDecrypt3DES() throws Exception{
        String keyUnderLMK = "952392F5CB403F240719CB199CFDC511";
        String chkDigit = "1DDD47BD92AF0000";
        String cryptogram = "D7C1E9FF33D3D42D";
        thalesHSMClient.decrypt3DES(keyUnderLMK, cryptogram);
    }

    @Test
    public void testAllTogether()throws Exception{
        thalesHSMClient.generatePrivateKey("2048", "010001");
        thalesHSMClient.generateDEK();
    }
    */
}
